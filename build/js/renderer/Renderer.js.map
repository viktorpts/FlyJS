{"version":3,"sources":["../../../js/renderer/Renderer.js"],"names":["Renderer","constructor","canvas","palette","ctx","getContext","draw","scene","x","y","clearRect","save","translate","i","static","length","drawObject","beginPath","moveTo","lineTo","stroke","dynamic","restore","obj","rotate","direction","img","sprite","w","width","scale","h","height","SMOKE","globalAlpha","life","drawImage","drawControls","input","strokeRect","keysPressed","fillRect"],"mappings":"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","file":"Renderer.js","sourcesContent":["import Sprite from '../enums/Sprite.js';\r\n\r\nexport default class Renderer {\r\n    constructor(canvas, palette) {\r\n        this.canvas = canvas;\r\n        this.palette = palette;\r\n        this.ctx = this.canvas.getContext('2d');\r\n    }\r\n\r\n    draw(scene, x = 0, y = 0) {\r\n        this.ctx.clearRect(0, 0, 800, 600);\r\n\r\n        // Center camera\r\n        this.ctx.save();\r\n        this.ctx.translate(x, y);\r\n\r\n        // Draw scenery\r\n        for (let i = 0; i < scene.static.length; i++) {\r\n            this.drawObject(scene.static[i]);\r\n        }\r\n\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(-5000, 550);\r\n        this.ctx.lineTo(5000, 550);\r\n        this.ctx.stroke();\r\n\r\n        // Draw entities\r\n        for (let i = 0; i < scene.dynamic.length; i++) {\r\n            this.drawObject(scene.dynamic[i]);\r\n        }\r\n\r\n        this.ctx.restore();\r\n    }\r\n\r\n    drawObject(obj) {\r\n        this.ctx.save();\r\n\r\n        this.ctx.translate(obj.x, obj.y);\r\n        this.ctx.rotate(obj.direction);\r\n\r\n        let img = this.palette[obj.sprite];\r\n        let w = img.width * obj.scale;\r\n        let h = img.height * obj.scale;\r\n        let x = -w * 0.5;\r\n        let y = -h * 0.5;\r\n\r\n        if (obj.sprite == Sprite.SMOKE) {\r\n            this.ctx.globalAlpha = obj.life / 100;\r\n        }\r\n\r\n        this.ctx.drawImage(img, x, y, w, h);\r\n\r\n        this.ctx.restore();\r\n\r\n        // Debug info\r\n        //this.ctx.fillText((obj.velX * obj.velX + obj.velY * obj.velY).toFixed(2), obj.x - 20, obj.y - 20);\r\n    }\r\n\r\n    drawControls(input) {\r\n        this.ctx.save();\r\n\r\n        this.ctx.strokeRect(716, 500, 12, 12); // Up\r\n        this.ctx.strokeRect(700, 516, 12, 12); // Left\r\n        this.ctx.strokeRect(716, 516, 12, 12); // Down\r\n        this.ctx.strokeRect(732, 516, 12, 12); // Right\r\n        this.ctx.strokeRect(700, 532, 44, 12); // Spacebar\r\n\r\n        if(input.keysPressed[\"ArrowLeft\"]) {\r\n            this.ctx.fillRect(700, 516, 12, 12);\r\n        }\r\n        if(input.keysPressed[\"ArrowRight\"]) {\r\n            this.ctx.fillRect(732, 516, 12, 12);\r\n        }\r\n        if(input.keysPressed[\"ArrowUp\"]) {\r\n            this.ctx.fillRect(716, 500, 12, 12);\r\n        }\r\n        if(input.keysPressed[\"ArrowDown\"]) {\r\n            this.ctx.fillRect(716, 516, 12, 12);\r\n        }\r\n        if(input.keysPressed[\"Space\"]) {\r\n            this.ctx.fillRect(700, 532, 44, 12);\r\n        }\r\n\r\n        this.ctx.restore();\r\n    }\r\n}"]}